ช่องโหว่ Sandbox Escape ของ itunesstored และ bookassetd 🚨🔐

โปรเจกต์นี้เป็นตัวอย่างสาธิต (Proof-of-Concept) ที่แสดงให้เห็นว่าไฟล์ฐานข้อมูล downloads.28.sqlitedb และ BLDatabaseManager.sqlite ที่ถูกดัดแปลงสามารถทำให้กระบวนการ itunesstored และ bookassetd หลุดออกจาก sandbox บน iOS ได้อย่างไร 📱💥
โดยอาศัยช่องโหว่ในระบบดาวน์โหลด ทำให้สามารถเขียนไฟล์ที่เป็นเจ้าของโดยผู้ใช้ mobile ไปยังพื้นที่ที่ปกติไม่อนุญาตใน /private/var/ รวมถึงไฟล์แคชของ MobileGestalt ซึ่งอาจถูกนำไปใช้เพื่อปรับแต่งข้อมูลอุปกรณ์ได้ เช่น การปลอมรุ่นเครื่อง 🛠️🧩

⸻

⭐ สาระสำคัญ
	•	รองรับ iOS 26.2b1 และต่ำกว่า (ทดสอบบน iPhone 12, iOS 26.0.1) 📲
	•	เฟสที่ 1 — itunesstored: ส่งไฟล์ BLDatabaseManager.sqlite ที่ถูกแก้ไขเข้าไปยังโฟลเดอร์ที่สามารถเขียนได้ 📦
	•	เฟสที่ 2 — bookassetd: ใช้ระบบดาวน์โหลด EPUB เพื่อเขียน payload ไปยังตำแหน่งไฟล์ที่ต้องการได้ตามใจ 💾➡️📂
	•	พื้นที่ที่สามารถเขียนไฟล์ได้ เช่น
	
	•	/private/var/containers/Shared/SystemGroup/.../Library/Caches/
	
	•	/private/var/mobile/Library/FairPlay/
	
	•	/private/var/mobile/Media/
	
	•	มีการสาธิตแก้ไขไฟล์ com.apple.MobileGestalt.plist เพื่อเช็กว่าช่องโหว่ทำงานสำเร็จจริง ✔️🔍

⸻

⚠️ ผลลัพธ์ของช่องโหว่

ระบบ iOS ไม่ได้บล็อกงานดาวน์โหลดที่ถูกปรับแต่งอย่างเหมาะสม ทำให้ผู้โจมตีสามารถเขียนไฟล์โดยไม่รับอนุญาตได้ ❗
ยกเว้นเฉพาะเส้นทางที่ต้องใช้สิทธิ์ระดับ root หรือไฟล์ที่ไม่ได้เป็นเจ้าของโดยผู้ใช้ mobile เท่านั้น 🔒

⸻

📚 ข้อมูลเพิ่มเติม

สามารถดูรายละเอียดในบล็อกโพสต์ของผู้พัฒนาได้ (ต้นทาง) 🌐

⸻

⚠️ ข้อควรระวัง

โปรเจกต์นี้สร้างขึ้นเพื่อ การศึกษาเท่านั้น 🎓
❌ ห้ามนำไปใช้ในทางผิดกฎหมาย
🍎 และ Apple สามารถปิดช่องโหว่นี้ได้ทุกเมื่อ
